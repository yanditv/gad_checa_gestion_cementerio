@model gad_checa_gestion_cementerio.Data.Contrato
@{
    ViewData["Title"] = "Crear Difunto";
}

<div class="p-4 bg-gray-50 border-gray-200 flex h-auto items-start justify-start rounded-xl border border-dashed dark:bg-neutral-700 dark:border-neutral-600">
    <div class="w-full max-w-2xl">
        <div class="px-5 py-10 relative w-full rounded-3xl sm:p-5"></div>
            <div class="max-w-full text-left">
                <h2 class="text-gray-700 mb-2 text-xl font-semibold">Datos del Contrato</h2>
                <p class="mb-6 text-sm text-[#6A717D]">Asegúrate de completar los campos necesarios</p>

                <form asp-action="CreateContrato" method="post">
                    <div class="mb-4">
                        <label asp-for="FechaInicio" class="block text-sm font-medium text-gray-700">Fecha de Inicio</label>
                        <input asp-for="FechaInicio" type="date" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md" />
                        <span asp-validation-for="FechaInicio" class="text-red-500 text-sm"></span>
                    </div>

                    <div class="mb-4">
                        <label asp-for="FechaFin" class="block text-sm font-medium text-gray-700">Fecha de Fin</label>
                        <input asp-for="FechaFin" type="date" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md" />
                        <span asp-validation-for="FechaFin" class="text-red-500 text-sm"></span>
                    </div>

                    <div class="mb-4">
                        <label asp-for="NumeroDeMeses" class="block text-sm font-medium text-gray-700">Número de Meses</label>
                        <input asp-for="NumeroDeMeses" type="number" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md" />
                        <span asp-validation-for="NumeroDeMeses" class="text-red-500 text-sm"></span>
                    </div>

                    <div class="mb-4">
                        <label asp-for="MontoTotal" class="block text-sm font-medium text-gray-700">Monto Total</label>
                        <input asp-for="MontoTotal" type="number" step="0.01" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md" />
                        <span asp-validation-for="MontoTotal" class="text-red-500 text-sm"></span>
                    </div>

                    <div class="mb-4">
                        <label asp-for="Estado" class="block text-sm font-medium text-gray-700">Estado</label>
                        <input asp-for="Estado" type="checkbox" class="mt-1 block" />
                        <span asp-validation-for="Estado" class="text-red-500 text-sm"></span>
                    </div>

                    <div class="mb-4">
                        <label asp-for="Observaciones" class="block text-sm font-medium text-gray-700">Observaciones</label>
                        <textarea asp-for="Observaciones" rows="3" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"></textarea>
                        <span asp-validation-for="Observaciones" class="text-red-500 text-sm"></span>
                    </div>

                    <div class="flex justify-end">
                        <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                            Guardar
                        </button>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.getElementById('FechaInicio').addEventListener('change', calcularCuotas);
        document.getElementById('FechaFin').addEventListener('change', calcularCuotas);
        document.getElementById('MontoTotal').addEventListener('input', calcularCuotas);

        function calcularCuotas() {
            var fechaInicio = new Date(document.getElementById('FechaInicio').value);
            var fechaFin = new Date(document.getElementById('FechaFin').value);
            var montoTotal = parseFloat(document.getElementById('MontoTotal').value);
            var cuotasContainer = document.getElementById('cuotasContainer');
            cuotasContainer.innerHTML = '';

            if (isNaN(fechaInicio) || isNaN(fechaFin) || isNaN(montoTotal)) {
                return;
            }

            var numeroDeMeses = (fechaFin.getFullYear() - fechaInicio.getFullYear()) * 12 + (fechaFin.getMonth() - fechaInicio.getMonth());
            document.getElementById('NumeroDeMeses').value = numeroDeMeses;

            var montoCuota = montoTotal / numeroDeMeses;

            for (var i = 0; i < numeroDeMeses; i++) {
                var cuotaFecha = new Date(fechaInicio);
                cuotaFecha.setMonth(cuotaFecha.getMonth() + i);

                var cuotaDiv = document.createElement('div');
                cuotaDiv.className = 'form-group';

                var cuotaLabel = document.createElement('label');
                cuotaLabel.innerText = 'Cuota ' + (i + 1) + ' - Fecha: ' + cuotaFecha.toLocaleDateString() + ' - Monto: ' + montoCuota.toFixed(2);
                cuotaDiv.appendChild(cuotaLabel);

                cuotasContainer.appendChild(cuotaDiv);
            }
        }
        </script>
    }